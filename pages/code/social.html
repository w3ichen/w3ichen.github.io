<!DOCTYPE html>
<html>
<head>
	<title>Code > Social Media</title>
</head>
<body>
	<nav>
		<h1>social media</h1>
		<button id="back" onclick="window.location.href='code.html'">back</button>
	</nav>
	<div id="content">
		<div id="newPostBox">
			<strong style="padding-left: 2%">New Post</strong>
			<textarea id="newPost" placeholder="What's on your mind?"></textarea>
			<div id="postBar">
				<input type="file" id="files" multiple name="files[]" accept="image/*"> 
				<button id="postBtn" onclick="post()">post</button>
			</div>
		</div>
		<div id="newContent">
		</div>
	</div>
</body>
</html>
<script type="text/javascript">
	window.onload = function(){
		console.log("cookies: "+document.cookie);
	}
	var postNum = 0;
	function post(){
		var message = document.getElementById("newPost").value;
		var date = new Date();
		const monthNames = ["January", "February", "March", "April", "May", "June",
  		"July", "August", "September", "October", "November", "December"];

		postNum ++;
		document.getElementById("newContent").innerHTML += 
		'<div class="contentBox" style="order:'+postNum+'" id="'+postNum+'">'+
			'<div class="date">'+monthNames[date.getMonth()]+' '+date.getDate()+' '+date.getFullYear()+" | "+date.getHours()+':'+date.getMinutes()+'</div><div>'+
				message+'</div><div class="attachments" id="attach'+postNum+'"></div><br><div class="comments" id="comments'+postNum+'"></div><div class="commentFlex"><input type="text" placeholder="Write a comment..." class="commentBar" id="c'+postNum+'" onkeydown="if(event.keyCode==13){document.getElementById(\'b'+postNum+'\').click()}"><button class="commentBtn" id="b'+postNum+'" onclick="postComment('+postNum+')">send</button></div></div>';

		// process files
		try{
			const input = document.querySelector('input[type="file"]');

			for (var i=0;i<input.files.length;i++){
				const reader = new FileReader();
				reader.onload = function(){
					const attachment = new Image(130);
					attachment.src = reader.result;
					document.getElementById('attach'+postNum+'').appendChild(attachment);
				}
				reader.readAsDataURL(input.files[i]);
			}
		}catch{
			console.log("no files selected")
		}
		
		// reset post box
		document.getElementById("newPost").value = "";
		document.getElementById("files").value = "";
		console.log(message);

		// rearrange order so new post is on top
		document.getElementById(postNum).style.order = 1;
		for (var i=1;i<postNum;i++){
			document.getElementById(i).style.order = (parseInt(document.getElementById(i).style.order)+1); 
		}

		document.cookie = String(document.getElementById("newContent").innerHTML);
		console.log("updating cookie: "+String(document.getElementById("newContent").innerHTML.text))
	}
	function postComment(postNumber){
		var date = new Date();
		var pushComment = document.getElementById("c"+postNumber).value;
		document.getElementById("c"+postNumber).value = "";
		document.getElementById("comments"+postNumber).innerHTML +=
		'<div class="newComment" style="width:max-content">'+pushComment+'&nbsp&nbsp&nbsp<em>'+date.getHours()+':'+date.getMinutes()+'</em></div>';
		// store to cookie
		document.cookie = String(document.getElementById("newContent").innerHTML);
		console.log("updating cookie: "+document.getElementById("newContent").innerHTML.text)
	}


</script>

<style type="text/css">
.attachments{
	margin-top: 1%;
	display: inline-flex;
	flex-direction: row;
	flex-wrap: wrap;
}
.thumb {
	height: 75px;
	border: 1px solid #000;
	margin: 10px 5px 0 0;
}
#newContent{
	display: flex;
	flex-direction: column;
}
em{
	font-size: 9px;
}
.newComment{
	background-color: #f2f2f2;
	border-radius: 15px;
	margin-top: 1%;
	margin-bottom: 1%;
	margin-left: 3%;
	padding: 1%;
	padding-left: 2%;
	padding-right: 2%;
	font-size: 12px;
}
.commentBtn{
	border-top-right-radius: 15px;
	border-bottom-right-radius: 15px;
	background-color: #3b5998; 
	color: white;
	border: none;
	cursor: pointer;
	width: 13%;
	font-size: 12px;
}
.commentBar{
	border-top-left-radius: 15px;
	border-bottom-left-radius: 15px;
	width: 82%;
	background-color: #f2f2f2;
	color: gray;
	border:none;
	margin-top: 1%;
	padding: 1%;
	padding-left: 3%;
	font-size: 13px;
}
.date{
	font-size: 10px;
	color: gray;
}
.contentBox{
	background-color: white;
	margin-top: 3%;
	margin-bottom: 3%;
	padding: 3%;
	font-family: arial;
	font-size: 15px;
}
#postBtn{
	background-color: #3b5998; 
	color: white;
	border: none;
	cursor: pointer;

}
#postBar{
	display: inline-flex;
	flex-direction: row;
	padding: 1%;
	float: right;
	margin-right: 1px;
}
#newPostBox{
	background-color: rgb(220,220,220);
	padding-top: 10px;
	margin-top: 3%;

}
#newPost{
	width: 94%;
	height: 50px;
	padding: 3%;
	border: none;
	vertical-align: top;
	font-family: arial;
	resize: none;
}
body{
	margin:0;
	font-family: arial;
	font-size: 15px;
	background-color: #EBECF0;

}
#content{
	display: inline-flex;
	flex-direction: column;
	margin-left: 25%;
	margin-right: 25%;
	width: 50%;
}
h1{
	margin-left: 15%;
	font-size: 25px;
	width: 50%;
}
nav{
	display: inline-flex;
	background-color: #3b5998;
	margin:0;
	padding: .3%;
	color:white;
	font-family: sans-serif;
	width: 100%;
	height: 35px;
	align-items: center;
}
#back{
	padding: .7%;
	margin-left: 15%;
	height: 100%;
	background-color: #3b5998;
	border: solid;
	border-width: 1px;
	color: white;

	cursor: pointer;
}
</style>